{% extends 'base.html' %}
{% load static %}
{% load custom_tags %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'GPTrivia/css/buzzer.css' %}">
{% endblock %}

{% block extra_meta %}
    <script>
        const socket = new WebSocket(
            (window.location.protocol === 'https:' ? 'wss://' : 'ws://') + window.location.host + '/ws/button/'
        );


        socket.onmessage = function(e) {
            const data = JSON.parse(e.data);
            const lastPressElement = document.getElementById('last-press');
            lastPressElement.textContent = data.username;

            // Add a class to trigger CSS transition
            lastPressElement.classList.add('updated');
            setTimeout(() => lastPressElement.classList.remove('updated'), 1000); // Remove after animation
        };


        function sendPress() {
            const username = document.getElementById('username').value;
            if (username) {
                socket.send(JSON.stringify({ username: username }));
            }
        }
    </script>
{% endblock %}

{% block content %}
    <body>
        <h1>Press the Button!</h1>
        <label for="username">Your Name:</label>
        <input type="text" id="username" placeholder="Enter your name" />
        <button onclick="sendPress()">Press Me!</button>

        <h3>Last person to press the button:</h3>
        <p id="last-press">No one yet</p>
    </body>
    </html>
{% endblock %}